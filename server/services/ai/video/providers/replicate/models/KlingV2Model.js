"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.KlingV2Model=void 0;const BaseReplicateModel_1=require("./BaseReplicateModel");const logger_1=require("../../../../../../utils/logger");class KlingV2Model extends BaseReplicateModel_1.BaseReplicateModel{constructor(e){super(e,"kwaivgi/kling-v2.1")}async generate(e){const t=this.validateOptions(e);if(t)return{success:false,error:t};try{const t={mode:e.mode||"standard",prompt:e.prompt,duration:e.duration||5,negative_prompt:e.negativePrompt||""};if(e.startImage)t.start_image=e.startImage;const r=await this.createPrediction(t);return{success:true,data:{id:r.id,status:this.mapPredictionStatus(r.status),duration:e.duration,progress:0,estimatedCompletionTime:new Date(Date.now()+12e4)},metadata:{model:this.modelId,mode:e.mode||"standard",hasStartImage:!!e.startImage,predictionId:r.id}}}catch(t){logger_1.logger.error("Kling v2.1 video generation failed",{error:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0,modelId:this.modelId,options:{prompt:e.prompt,duration:e.duration,mode:e.mode,hasStartImage:!!e.startImage}});return{success:false,error:t instanceof Error?t.message:"Failed to generate video"}}}validateOptions(e){if(!e.prompt||0===e.prompt.trim().length)return"Prompt is required for Kling v2.1";if(e.duration&&(e.duration<1||e.duration>10))return"Duration must be between 1 and 10 seconds";if(e.mode&&!["standard","pro"].includes(e.mode))return'Mode must be either "standard" or "pro"';return null}getRequiredFields(){return["prompt"]}}exports.KlingV2Model=KlingV2Model;