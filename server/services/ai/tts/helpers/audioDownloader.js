"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(t,e,r,o){if(void 0===o)o=r;var n=Object.getOwnPropertyDescriptor(e,r);if(!n||("get"in n?!e.__esModule:n.writable||n.configurable))n={enumerable:true,get:function(){return e[r]}};Object.defineProperty(t,o,n)}:function(t,e,r,o){if(void 0===o)o=r;t[o]=e[r]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:true,value:e})}:function(t,e){t.default=e});var __importStar=this&&this.__importStar||function(){var ownKeys=function(t){ownKeys=Object.getOwnPropertyNames||function(t){var e=[];for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r))e[e.length]=r;return e};return ownKeys(t)};return function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r=ownKeys(t),o=0;o<r.length;o++)if("default"!==r[o])__createBinding(e,t,r[o]);__setModuleDefault(e,t);return e}}();Object.defineProperty(exports,"__esModule",{value:true});exports.downloadAudio=downloadAudio;const https=__importStar(require("https"));const http=__importStar(require("http"));const logger_1=require("../../../../utils/logger");async function downloadAudio(t){return new Promise((e,r)=>{const o=[];("https:"===new URL(t).protocol?https:http).get(t,t=>{if(301===t.statusCode||302===t.statusCode){const o=t.headers.location;if(o){downloadAudio(o).then(e).catch(r);return}}if(200!==t.statusCode){r(new Error(`Failed to download audio: ${t.statusCode}`));return}t.on("data",t=>{o.push(t)});t.on("end",()=>{e(Buffer.concat(o))});t.on("error",r)}).on("error",t=>{logger_1.logger.error("[MinimaxTTS] Download error:",t);r(t)})})}